<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org"> <head>
    <meta charset="UTF-8">
    <title>出席詳細</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/attendance_detail.css}">
    </head>
<body>
    <header th:replace="~{base/header :: header}"></header>

    <main class="attendance-detail-container">
        <h2>授業出席詳細</h2>
        
        <section id="class-info" class="class-info">
            <p><strong>授業名：</strong> <span th:text="${subjectName}">[授業名]</span></p>
            <p th:if="${attendanceDetails != null and !attendanceDetails.empty}">
                <strong>日付：</strong> 
                <span th:text="${#temporals.format(attendanceDetails.get(0).id.sessionDatetime, 'yyyy-MM-dd (E) HH:mm')}"></span>
            </p>
            <p th:if="${attendanceDetails != null and !attendanceDetails.empty}">
                <strong>出席人数：</strong>
                <span th:text="${attendanceCount}">0</span> 人
            </p>
        </section>

        <section class="student-list-section">
            <h3>出席学生一覧</h3>
            <table class="student-table">
                <thead>
                    <tr>
                        <th>学生番号</th>
                        <th>氏名</th>
                        <th>出席時間</th> <th>出欠</th>
                        <th>備考</th>
                    </tr>
                </thead>
                <tbody id="studentTableBody">
                    <tr th:each="a : ${attendanceDetails}" th:if="${attendanceDetails != null and !attendanceDetails.empty}">
                        <td th:text="${a.student.userId}"></td> <!-- 学生番号 -->
                        <td th:text="${a.student.userName}"></td> <!-- 氏名 -->
                        <td th:text="${#temporals.format(a.attendedOn, 'HH:mm')}"></td> <!-- 出席時間 -->
                        <td th:text="${a.isAttended ? '出席' : '欠席'}"></td> <!-- 出欠 -->
                        <td th:text="${a.remark == '1' ? '遅刻' : (a.remark == '2' ? '早退' : '')}"></td>
                    </tr>
                    <tr th:if="${attendanceDetails == null or attendanceDetails.empty}">
                        <td colspan="5">該当する学生の出席データがありません。</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <button class="back-btn" onclick="history.back()">戻る</button>
    </main>
</body>
</html>