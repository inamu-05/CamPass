<head>
  <meta charset="UTF-8">
  <title>学生情報検索</title>
  <link rel="stylesheet" th:href="@{/css/student_search.css}">
  <link rel="stylesheet" th:href="@{/css/style.css}">
  <script th:src="@{/js/student_search.js}"></script>
</head>

<!-- サーバーサイドで base/header.html の header-content フラグメントを挿入 -->
<div id="header-container" th:insert="~{base/header :: header}"></div>

<section class="student-search-container">
  <h2>学生情報検索</h2>

  <div class="search-bar">
    <form th:action="@{/student/search}" method="get">
      <input type="text" name="keyword" placeholder="学生名やIDを入力" th:value="${keyword}">
      <select name="status">
        <option value="" th:selected="${status == null || status.isEmpty()}">全ての在籍状態</option>
        <option value="1" th:selected="${status == '1'}">在学</option>
        <option value="2" th:selected="${status == '2'}">卒業</option>
        <option value="3" th:selected="${status == '3'}">休学</option>
        <option value="4" th:selected="${status == '4'}">退学</option>
      </select>
      <button type="submit">検索</button>
    </form>
  </div>

  <div class="search-results">
    <table id="student-table">
      <thead>
        <tr>
          <th>学生番号</th>
          <th>氏名</th>
          <th>クラス</th>
          <th>更新</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="student : ${students}">
          <td th:text="${student.userId}"></td>
          <td th:text="${student.userName}"></td>
          <td th:text="${student.enrollmentStatus == '2' ? '卒業' : 
            (student.enrollmentStatus == '3' ? student.classGroup.classGroup + '（休学）' : 
            (student.enrollmentStatus == '4' ? '退学' : student.classGroup.classGroup))}">
          </td>
          <td>
            <a th:href="@{'/student/update/' + ${student.userId}}">
              <button class="btn" th:text="${student.enrollmentStatus == '2' || student.enrollmentStatus == '4'} ? '詳細' : '更新'"></button>
            </a>
          </td>
        </tr>
      </tbody>
    </table> 
  </div>
</section>

